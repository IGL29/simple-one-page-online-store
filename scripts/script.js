"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var r=0;r<this.length;r++)t.call(e,this[r],r,this)}),Array.from||(Array.from=function(){var t=Object.prototype.toString,e=function(e){return"function"==typeof e||"[object Function]"===t.call(e)},r=Math.pow(2,53)-1,o=function(t){var e=function(t){var e=Number(t);return isNaN(e)?0:0!==e&&isFinite(e)?(e>0?1:-1)*Math.floor(Math.abs(e)):e}(t);return Math.min(Math.max(e,0),r)};return function(t){var r=this,n=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var i,a=arguments.length>1?arguments[1]:void 0;if(void 0!==a){if(!e(a))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(i=arguments[2])}for(var l,s=o(n.length),c=e(r)?Object(new r(s)):new Array(s),u=0;u<s;)l=n[u],c[u]=a?void 0===i?a(l,u):a.call(i,l,u):l,u+=1;return c.length=s,c}}());var buttonScrollElem=document.querySelector(".scroll-top"),cardProductsListElem=document.querySelector(".catalog-list"),sortButtonsElems=document.querySelectorAll(".sort-item"),likeButtons=document.querySelectorAll(".like-btn"),notification=document.querySelector(".notification"),notificationBtn=document.querySelector(".notification__btn"),emailInputElem=document.querySelector(".form__input"),emailLabelElem=document.querySelector(".form__label"),formElem=document.querySelector(".form"),timerId=null;function sortCards(){var t=Array.from(cardProductsListElem.children);if("inactive"===this.dataset.sortstate&&(sortButtonsElems.forEach((function(t){return t.dataset.sortstate="inactive"})),this.dataset.sortstate="active"),"unSorted"===this.dataset.sort||"uSort"===this.dataset.sort){var e="price"===this.dataset.title?".article__price":".age";t.sort((function(t,r){var o=t.querySelector(e).innerText,n=r.querySelector(e).innerText;return(o=o.match(/\d+/g).join(""))-(n=n.match(/\d+/g).join(""))})),this.dataset.sort="aSort"}else"aSort"===this.dataset.sort&&(t.reverse(),this.dataset.sort="uSort");for(let e=0;t.length>e;e++)cardProductsListElem.appendChild(t[e])}function like(){"like"===this.dataset.status?(this.dataset.status="",notification.classList.remove("notification-active")):(this.dataset.status="like",notification.classList.add("notification-active"),timerId=setInterval(notificationClose,2e3))}function notificationClose(){clearTimeout(timerId),notification.classList.remove("notification-active")}function validate(t){t.preventDefault();var e=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,r=this.value;!1!==e.test(r)||document.querySelector(".invalid-input")?!0!==e.test(r)&&""!==r||!document.querySelector(".invalid-input")||document.querySelector(".invalid-input").remove():emailLabelElem.insertAdjacentHTML("afterbegin",'<span class="invalid-input">Введите корректный e-mail</span>')}sortButtonsElems.forEach((function(t){return t.addEventListener("click",sortCards)})),window.addEventListener("scroll",(function(){window.pageYOffset>90?buttonScrollElem.classList.add("scroll-top-active"):buttonScrollElem.classList.remove("scroll-top-active")}),{passive:!0}),buttonScrollElem.addEventListener("click",(function(){window.scrollTo({top:0,behavior:"smooth"})})),likeButtons.forEach((function(t){return t.addEventListener("click",like)})),notificationBtn.addEventListener("click",notificationClose),emailInputElem.addEventListener("input",validate),formElem.addEventListener("submit",validate);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJfdG9Db25zdW1hYmxlQXJyYXkiLCJhcnIiLCJfYXJyYXlXaXRob3V0SG9sZXMiLCJfaXRlcmFibGVUb0FycmF5IiwiX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5IiwiX25vbkl0ZXJhYmxlU3ByZWFkIiwiVHlwZUVycm9yIiwibyIsIm1pbkxlbiIsIl9hcnJheUxpa2VUb0FycmF5IiwibiIsIk9iamVjdCIsInByb3RvdHlwZSIsInRvU3RyaW5nIiwiY2FsbCIsInNsaWNlIiwiY29uc3RydWN0b3IiLCJuYW1lIiwiQXJyYXkiLCJmcm9tIiwidGVzdCIsIml0ZXIiLCJTeW1ib2wiLCJpdGVyYXRvciIsImlzQXJyYXkiLCJsZW4iLCJsZW5ndGgiLCJpIiwiYXJyMiIsIndpbmRvdyIsIk5vZGVMaXN0IiwiZm9yRWFjaCIsImNhbGxiYWNrIiwidGhpc0FyZyIsInRoaXMiLCJ0b1N0ciIsImlzQ2FsbGFibGUiLCJmbiIsIm1heFNhZmVJbnRlZ2VyIiwiTWF0aCIsInBvdyIsInRvTGVuZ3RoIiwidmFsdWUiLCJudW1iZXIiLCJOdW1iZXIiLCJpc05hTiIsImlzRmluaXRlIiwiZmxvb3IiLCJhYnMiLCJ0b0ludGVnZXIiLCJtaW4iLCJtYXgiLCJhcnJheUxpa2UiLCJDIiwiaXRlbXMiLCJUIiwibWFwRm4iLCJhcmd1bWVudHMiLCJrVmFsdWUiLCJBIiwiayIsImJ1dHRvblNjcm9sbEVsZW0iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjYXJkUHJvZHVjdHNMaXN0RWxlbSIsInNvcnRCdXR0b25zRWxlbXMiLCJxdWVyeVNlbGVjdG9yQWxsIiwibGlrZUJ1dHRvbnMiLCJub3RpZmljYXRpb24iLCJub3RpZmljYXRpb25CdG4iLCJlbWFpbElucHV0RWxlbSIsImVtYWlsTGFiZWxFbGVtIiwiZm9ybUVsZW0iLCJ0aW1lcklkIiwic29ydENhcmRzIiwiYXJyQ2FyZFByb2R1Y3RzIiwiY2hpbGRyZW4iLCJkYXRhc2V0Iiwic29ydHN0YXRlIiwiYnV0dG9uIiwic29ydCIsImtleVNvcnRFbGVtIiwidGl0bGUiLCJhIiwiYiIsInZhbHVlMSIsImlubmVyVGV4dCIsInZhbHVlMiIsIm1hdGNoIiwiam9pbiIsInJldmVyc2UiLCJhcHBlbmRDaGlsZCIsImxpa2UiLCJzdGF0dXMiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJzZXRJbnRlcnZhbCIsIm5vdGlmaWNhdGlvbkNsb3NlIiwiY2xlYXJUaW1lb3V0IiwidmFsaWRhdGUiLCJldiIsInByZXZlbnREZWZhdWx0IiwicmVnIiwiZW1haWwiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJhZGRFdmVudExpc3RlbmVyIiwicGFnZVlPZmZzZXQiLCJwYXNzaXZlIiwic2Nyb2xsVG8iLCJ0b3AiLCJiZWhhdmlvciJdLCJtYXBwaW5ncyI6IkFBQUEsYUFFQSxTQUFBQSxtQkFBQUMsR0FBQSxPQUFBQyxtQkFBQUQsSUFBQUUsaUJBQUFGLElBQUFHLDRCQUFBSCxJQUFBSSxxQkFFQSxTQUFBQSxxQkFBQSxNQUFBLElBQUFDLFVBQUEsd0lBRUEsU0FBQUYsNEJBQUFHLEVBQUFDLEdBQUEsR0FBQUQsRUFBQSxDQUFBLEdBQUEsaUJBQUFBLEVBQUEsT0FBQUUsa0JBQUFGLEVBQUFDLEdBQUEsSUFBQUUsRUFBQUMsT0FBQUMsVUFBQUMsU0FBQUMsS0FBQVAsR0FBQVEsTUFBQSxHQUFBLEdBQUEsTUFBQSxXQUFBTCxHQUFBSCxFQUFBUyxjQUFBTixFQUFBSCxFQUFBUyxZQUFBQyxNQUFBLFFBQUFQLEdBQUEsUUFBQUEsRUFBQVEsTUFBQUMsS0FBQVosR0FBQSxjQUFBRyxHQUFBLDJDQUFBVSxLQUFBVixHQUFBRCxrQkFBQUYsRUFBQUMsUUFBQSxHQUVBLFNBQUFMLGlCQUFBa0IsR0FBQSxHQUFBLG9CQUFBQyxRQUFBLE1BQUFELEVBQUFDLE9BQUFDLFdBQUEsTUFBQUYsRUFBQSxjQUFBLE9BQUFILE1BQUFDLEtBQUFFLEdBRUEsU0FBQW5CLG1CQUFBRCxHQUFBLEdBQUFpQixNQUFBTSxRQUFB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QUFBLHVCQUNBLENBQ0FhLFNBQUEsSUFHQS9DLGlCQUFBNkMsaUJBQUEsU0FBQSxXQUNBN0UsT0FBQWdGLFNBQUEsQ0FDQUMsSUFBQSxFQUNBQyxTQUFBLGNBSUE1QyxZQUFBcEMsU0FBQSxTQUFBZ0QsR0FDQSxPQUFBQSxFQUFBMkIsaUJBQUEsUUFBQWQsU0FHQXZCLGdCQUFBcUMsaUJBQUEsUUFBQVIsbUJBQ0E1QixlQUFBb0MsaUJBQUEsUUFBQU4sVUFDQTVCLFNBQUFrQyxpQkFBQSxTQUFBTiIsImZpbGUiOiJzY3JpcHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XHJcblxyXG5mdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7IH1cclxuXHJcbmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7IH1cclxuXHJcbmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09IFwiT2JqZWN0XCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09IFwiTWFwXCIgfHwgbiA9PT0gXCJTZXRcIikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSBcIkFyZ3VtZW50c1wiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfVxyXG5cclxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7IGlmICh0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIGl0ZXJbU3ltYm9sLml0ZXJhdG9yXSAhPSBudWxsIHx8IGl0ZXJbXCJAQGl0ZXJhdG9yXCJdICE9IG51bGwpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOyB9XHJcblxyXG5mdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShhcnIpOyB9XHJcblxyXG5mdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH1cclxuXHJcbmlmICh3aW5kb3cuTm9kZUxpc3QgJiYgIU5vZGVMaXN0LnByb3RvdHlwZS5mb3JFYWNoKSB7XHJcbiAgTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHRoaXNBcmcpIHtcclxuICAgICAgdGhpc0FyZyA9IHRoaXNBcmcgfHwgd2luZG93O1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdGhpc1tpXSwgaSwgdGhpcyk7XHJcbiAgICAgIH1cclxuICB9O1xyXG59XHJcbmlmICghQXJyYXkuZnJvbSkge1xyXG4gIEFycmF5LmZyb20gPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHRvU3RyID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcclxuICAgIHZhciBpc0NhbGxhYmxlID0gZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgIHJldHVybiB0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicgfHwgdG9TdHIuY2FsbChmbikgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XHJcbiAgICB9O1xyXG4gICAgdmFyIHRvSW50ZWdlciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICB2YXIgbnVtYmVyID0gTnVtYmVyKHZhbHVlKTtcclxuICAgICAgaWYgKGlzTmFOKG51bWJlcikpIHsgcmV0dXJuIDA7IH1cclxuICAgICAgaWYgKG51bWJlciA9PT0gMCB8fCAhaXNGaW5pdGUobnVtYmVyKSkgeyByZXR1cm4gbnVtYmVyOyB9XHJcbiAgICAgIHJldHVybiAobnVtYmVyID4gMCA/IDEgOiAtMSkgKiBNYXRoLmZsb29yKE1hdGguYWJzKG51bWJlcikpO1xyXG4gICAgfTtcclxuICAgIHZhciBtYXhTYWZlSW50ZWdlciA9IE1hdGgucG93KDIsIDUzKSAtIDE7XHJcbiAgICB2YXIgdG9MZW5ndGggPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgdmFyIGxlbiA9IHRvSW50ZWdlcih2YWx1ZSk7XHJcbiAgICAgIHJldHVybiBNYXRoLm1pbihNYXRoLm1heChsZW4sIDApLCBtYXhTYWZlSW50ZWdlcik7XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBmdW5jdGlvbiBmcm9tKGFycmF5TGlrZSkge1xyXG4gICAgICB2YXIgQyA9IHRoaXM7XHJcblxyXG4gICAgICB2YXIgaXRlbXMgPSBPYmplY3QoYXJyYXlMaWtlKTtcclxuXHJcbiAgICAgIGlmIChhcnJheUxpa2UgPT0gbnVsbCkge1xyXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJBcnJheS5mcm9tIHJlcXVpcmVzIGFuIGFycmF5LWxpa2Ugb2JqZWN0IC0gbm90IG51bGwgb3IgdW5kZWZpbmVkXCIpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YXIgbWFwRm4gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHZvaWQgdW5kZWZpbmVkO1xyXG4gICAgICB2YXIgVDtcclxuICAgICAgaWYgKHR5cGVvZiBtYXBGbiAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICBpZiAoIWlzQ2FsbGFibGUobWFwRm4pKSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcnJheS5mcm9tOiB3aGVuIHByb3ZpZGVkLCB0aGUgc2Vjb25kIGFyZ3VtZW50IG11c3QgYmUgYSBmdW5jdGlvbicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHtcclxuICAgICAgICAgIFQgPSBhcmd1bWVudHNbMl07XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHZhciBsZW4gPSB0b0xlbmd0aChpdGVtcy5sZW5ndGgpO1xyXG4gICAgICB2YXIgQSA9IGlzQ2FsbGFibGUoQykgPyBPYmplY3QobmV3IEMobGVuKSkgOiBuZXcgQXJyYXkobGVuKTtcclxuICAgICAgdmFyIGsgPSAwO1xyXG4gICAgICB2YXIga1ZhbHVlO1xyXG4gICAgICB3aGlsZSAoayA8IGxlbikge1xyXG4gICAgICAgIGtWYWx1ZSA9IGl0ZW1zW2tdO1xyXG4gICAgICAgIGlmIChtYXBGbikge1xyXG4gICAgICAgICAgQVtrXSA9IHR5cGVvZiBUID09PSAndW5kZWZpbmVkJyA/IG1hcEZuKGtWYWx1ZSwgaykgOiBtYXBGbi5jYWxsKFQsIGtWYWx1ZSwgayk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIEFba10gPSBrVmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGsgKz0gMTtcclxuICAgICAgfVxyXG4gICAgICBBLmxlbmd0aCA9IGxlbjtcclxuICAgICAgcmV0dXJuIEE7XHJcbiAgICB9O1xyXG4gIH0oKSk7XHJcbn1cclxuXHJcbnZhciBidXR0b25TY3JvbGxFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNjcm9sbC10b3AnKTtcclxudmFyIGNhcmRQcm9kdWN0c0xpc3RFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhdGFsb2ctbGlzdCcpO1xyXG52YXIgc29ydEJ1dHRvbnNFbGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zb3J0LWl0ZW0nKTtcclxudmFyIGxpa2VCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmxpa2UtYnRuJyk7XHJcbnZhciBub3RpZmljYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubm90aWZpY2F0aW9uJyk7XHJcbnZhciBub3RpZmljYXRpb25CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubm90aWZpY2F0aW9uX19idG4nKTtcclxudmFyIGVtYWlsSW5wdXRFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fX2lucHV0Jyk7XHJcbnZhciBlbWFpbExhYmVsRWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19sYWJlbCcpO1xyXG52YXIgZm9ybUVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybScpO1xyXG52YXIgdGltZXJJZCA9IG51bGw7XHJcblxyXG5mdW5jdGlvbiBzb3J0Q2FyZHMoKSB7XHJcbiAgdmFyIGFyckNhcmRQcm9kdWN0cyA9IEFycmF5LmZyb20oY2FyZFByb2R1Y3RzTGlzdEVsZW0uY2hpbGRyZW4pO1xyXG5cclxuICBpZiAodGhpcy5kYXRhc2V0LnNvcnRzdGF0ZSA9PT0gJ2luYWN0aXZlJykge1xyXG4gICAgc29ydEJ1dHRvbnNFbGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChidXR0b24pIHtcclxuICAgICAgcmV0dXJuIGJ1dHRvbi5kYXRhc2V0LnNvcnRzdGF0ZSA9ICdpbmFjdGl2ZSc7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuZGF0YXNldC5zb3J0c3RhdGUgPSAnYWN0aXZlJztcclxuICB9XHJcblxyXG4gIGlmICh0aGlzLmRhdGFzZXQuc29ydCA9PT0gJ3VuU29ydGVkJyB8fCB0aGlzLmRhdGFzZXQuc29ydCA9PT0gJ3VTb3J0Jykge1xyXG4gICAgdmFyIGtleVNvcnRFbGVtID0gdGhpcy5kYXRhc2V0LnRpdGxlID09PSAncHJpY2UnID8gJy5hcnRpY2xlX19wcmljZScgOiAnLmFnZSc7XHJcbiAgICBhcnJDYXJkUHJvZHVjdHMuc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICB2YXIgdmFsdWUxID0gYS5xdWVyeVNlbGVjdG9yKGtleVNvcnRFbGVtKS5pbm5lclRleHQ7XHJcbiAgICAgIHZhciB2YWx1ZTIgPSBiLnF1ZXJ5U2VsZWN0b3Ioa2V5U29ydEVsZW0pLmlubmVyVGV4dDtcclxuICAgICAgdmFsdWUxID0gdmFsdWUxLm1hdGNoKC9cXGQrL2cpLmpvaW4oJycpO1xyXG4gICAgICB2YWx1ZTIgPSB2YWx1ZTIubWF0Y2goL1xcZCsvZykuam9pbignJyk7XHJcbiAgICAgIHJldHVybiB2YWx1ZTEgLSB2YWx1ZTI7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuZGF0YXNldC5zb3J0ID0gJ2FTb3J0JztcclxuICB9IGVsc2UgaWYgKHRoaXMuZGF0YXNldC5zb3J0ID09PSAnYVNvcnQnKSB7XHJcbiAgICBhcnJDYXJkUHJvZHVjdHMucmV2ZXJzZSgpO1xyXG4gICAgdGhpcy5kYXRhc2V0LnNvcnQgPSAndVNvcnQnO1xyXG4gIH1cclxuXHJcbiAgZm9yIChsZXQgaSA9IDA7IGFyckNhcmRQcm9kdWN0cy5sZW5ndGggPiBpOyBpKyspIHtcclxuICAgIGNhcmRQcm9kdWN0c0xpc3RFbGVtLmFwcGVuZENoaWxkKGFyckNhcmRQcm9kdWN0c1tpXSk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBsaWtlKCkge1xyXG4gIGlmICh0aGlzLmRhdGFzZXQuc3RhdHVzID09PSBcImxpa2VcIikge1xyXG4gICAgdGhpcy5kYXRhc2V0LnN0YXR1cyA9ICcnO1xyXG4gICAgbm90aWZpY2F0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ25vdGlmaWNhdGlvbi1hY3RpdmUnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhpcy5kYXRhc2V0LnN0YXR1cyA9ICdsaWtlJztcclxuICAgIG5vdGlmaWNhdGlvbi5jbGFzc0xpc3QuYWRkKCdub3RpZmljYXRpb24tYWN0aXZlJyk7XHJcbiAgICB0aW1lcklkID0gc2V0SW50ZXJ2YWwobm90aWZpY2F0aW9uQ2xvc2UsIDIwMDApO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gbm90aWZpY2F0aW9uQ2xvc2UoKSB7XHJcbiAgY2xlYXJUaW1lb3V0KHRpbWVySWQpO1xyXG4gIG5vdGlmaWNhdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdub3RpZmljYXRpb24tYWN0aXZlJyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbGlkYXRlKGV2KSB7XHJcbiAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICB2YXIgcmVnID0gL14oW0EtWmEtejAtOV9cXC1cXC5dKStcXEAoW0EtWmEtejAtOV9cXC1cXC5dKStcXC4oW0EtWmEtel17Miw0fSkkLztcclxuICB2YXIgZW1haWwgPSB0aGlzLnZhbHVlO1xyXG4gIHZhciBtZXNzYWdlID0gXCI8c3BhbiBjbGFzcz1cXFwiaW52YWxpZC1pbnB1dFxcXCI+XFx1MDQxMlxcdTA0MzJcXHUwNDM1XFx1MDQzNFxcdTA0MzhcXHUwNDQyXFx1MDQzNSBcXHUwNDNBXFx1MDQzRVxcdTA0NDBcXHUwNDQwXFx1MDQzNVxcdTA0M0FcXHUwNDQyXFx1MDQzRFxcdTA0NEJcXHUwNDM5IGUtbWFpbDwvc3Bhbj5cIjtcclxuXHJcbiAgaWYgKHJlZy50ZXN0KGVtYWlsKSA9PT0gZmFsc2UgJiYgIWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbnZhbGlkLWlucHV0JykpIHtcclxuICAgIGVtYWlsTGFiZWxFbGVtLmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsIG1lc3NhZ2UpO1xyXG4gIH0gZWxzZSBpZiAoKHJlZy50ZXN0KGVtYWlsKSA9PT0gdHJ1ZSB8fCBlbWFpbCA9PT0gJycpICYmIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbnZhbGlkLWlucHV0JykpIHtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbnZhbGlkLWlucHV0JykucmVtb3ZlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5zb3J0QnV0dG9uc0VsZW1zLmZvckVhY2goZnVuY3Rpb24gKGJ1dHRvbikge1xyXG4gIHJldHVybiBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzb3J0Q2FyZHMpO1xyXG59KTtcclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBmdW5jdGlvbiAoKSB7XHJcbiAgd2luZG93LnBhZ2VZT2Zmc2V0ID4gOTAgPyBidXR0b25TY3JvbGxFbGVtLmNsYXNzTGlzdC5hZGQoJ3Njcm9sbC10b3AtYWN0aXZlJykgOiBidXR0b25TY3JvbGxFbGVtLmNsYXNzTGlzdC5yZW1vdmUoJ3Njcm9sbC10b3AtYWN0aXZlJyk7XHJcbn0sIHtcclxuICBwYXNzaXZlOiB0cnVlXHJcbn0pO1xyXG5cclxuYnV0dG9uU2Nyb2xsRWxlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICB3aW5kb3cuc2Nyb2xsVG8oe1xyXG4gICAgdG9wOiAwLFxyXG4gICAgYmVoYXZpb3I6ICdzbW9vdGgnXHJcbiAgfSk7XHJcbn0pO1xyXG5cclxubGlrZUJ1dHRvbnMuZm9yRWFjaChmdW5jdGlvbiAoYnV0dG9uKSB7XHJcbiAgcmV0dXJuIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGxpa2UpO1xyXG59KTtcclxuXHJcbm5vdGlmaWNhdGlvbkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG5vdGlmaWNhdGlvbkNsb3NlKTtcclxuZW1haWxJbnB1dEVsZW0uYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB2YWxpZGF0ZSk7XHJcbmZvcm1FbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHZhbGlkYXRlKTtcclxuIl19
